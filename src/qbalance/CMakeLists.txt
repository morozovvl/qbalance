cmake_minimum_required(VERSION 3.13)
set(VERSION "0.18")
set (PROJECT qb_main)
project (${PROJECT})

set(CMAKE_AUTOMOC ON)
find_package (Qt4 REQUIRED)


add_subdirectory(engine)
add_subdirectory(gui)
add_subdirectory(kernel)
add_subdirectory(storage)
add_subdirectory(report)
add_subdirectory(plugins)
add_subdirectory(openoffice)
add_subdirectory(emailclient)
set(SUBDIRS kernel gui report openoffice plugins storage engine emailclient)

add_executable(${PROJECT} main.cpp ${SUBDIRS})
target_link_libraries(${PROJECT} ${SUBDIRS} Qt4::QtGui Qt4::QtCore Qt4::QtSql Qt4::QtScript Qt4::QtXml Qt4::QtNetwork Qt4::QtDesigner)

set(CPACK_BINARY_RPM ON)
set(CPACK_RPM_COMPONENT_INSTALL ON)
set(CPACK_PACKAGE_VERSION ${VERSION})
set(CPACK_GENERATOR "RPM")
set(CPACK_PACKAGE_NAME ${PROJECT})
set(CPACK_PACKAGE_RELEASE 1)
set(CPACK_PACKAGE_CONTACT "NoName")
set(CPACK_PACKAGE_VENDOR "Some Vendor")
set(CPACK_PACKAGING_INSTALL_PREFIX ${CMAKE_INSTALL_PREFIX})
set(CPACK_PACKAGE_FILE_NAME "${CPACK_PACKAGE_NAME}-${CPACK_PACKAGE_VERSION}-${CPACK_PACKAGE_RELEASE}.${CMAKE_SYSTEM_PROCESSOR}")
set(CMAKE_INSTALL_PREFIX /usr)
install(TARGETS ${PROJECT} DESTINATION applications)

include(CPack)
